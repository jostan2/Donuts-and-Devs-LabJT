{"ast":null,"code":"(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : global.TinyDatePicker = factory();\n})(this, function () {\n  'use strict';\n  /**\n   * @file A generic set of mutation-free date functions.\n   */\n\n  /**\n   * now returns the current date without any time values\n   *\n   * @returns {Date}\n   */\n\n  function now() {\n    var dt = new Date();\n    dt.setHours(0, 0, 0, 0);\n    return dt;\n  }\n  /**\n   * dateEq compares two dates\n   *\n   * @param {Date} date1 the first date\n   * @param {Date} date2 the second date\n   * @returns {boolean}\n   */\n\n\n  function datesEq(date1, date2) {\n    return (date1 && date1.toDateString()) === (date2 && date2.toDateString());\n  }\n  /**\n   * shiftDay shifts the specified date by n days\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @returns {Date}\n   */\n\n\n  function shiftDay(dt, n) {\n    dt = new Date(dt);\n    dt.setDate(dt.getDate() + n);\n    return dt;\n  }\n  /**\n   * shiftMonth shifts the specified date by a specified number of months\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @param {boolean} wrap optional, if true, does not change year\n   *                       value, defaults to false\n   * @returns {Date}\n   */\n\n\n  function shiftMonth(dt, n, wrap) {\n    dt = new Date(dt);\n    var dayOfMonth = dt.getDate();\n    var month = dt.getMonth() + n;\n    dt.setDate(1);\n    dt.setMonth(wrap ? (12 + month) % 12 : month);\n    dt.setDate(dayOfMonth); // If dayOfMonth = 31, but the target month only has 30 or 29 or whatever...\n    // head back to the max of the target month\n\n    if (dt.getDate() < dayOfMonth) {\n      dt.setDate(0);\n    }\n\n    return dt;\n  }\n  /**\n   * shiftYear shifts the specified date by n years\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @returns {Date}\n   */\n\n\n  function shiftYear(dt, n) {\n    dt = new Date(dt);\n    dt.setFullYear(dt.getFullYear() + n);\n    return dt;\n  }\n  /**\n   * setYear changes the specified date to the specified year\n   *\n   * @param {Date} dt\n   * @param {number} year\n   */\n\n\n  function setYear(dt, year) {\n    dt = new Date(dt);\n    dt.setFullYear(year);\n    return dt;\n  }\n  /**\n   * setMonth changes the specified date to the specified month\n   *\n   * @param {Date} dt\n   * @param {number} month\n   */\n\n\n  function setMonth(dt, month) {\n    return shiftMonth(dt, month - dt.getMonth());\n  }\n  /**\n   * dateOrParse creates a function which, given a date or string, returns a date\n   *\n   * @param {function} parse the function used to parse strings\n   * @returns {function}\n   */\n\n\n  function dateOrParse(parse) {\n    return function (dt) {\n      return dropTime(typeof dt === 'string' ? parse(dt) : dt);\n    };\n  }\n  /**\n   * constrainDate returns dt or min/max depending on whether dt is out of bounds (inclusive)\n   *\n   * @export\n   * @param {Date} dt\n   * @param {Date} min\n   * @param {Date} max\n   * @returns {Date}\n   */\n\n\n  function constrainDate(dt, min, max) {\n    return dt < min ? min : dt > max ? max : dt;\n  }\n\n  function dropTime(dt) {\n    dt = new Date(dt);\n    dt.setHours(0, 0, 0, 0);\n    return dt;\n  }\n  /**\n   * @file Utility functions for function manipulation.\n   */\n\n  /**\n   * bufferFn buffers calls to fn so they only happen every ms milliseconds\n   *\n   * @param {number} ms number of milliseconds\n   * @param {function} fn the function to be buffered\n   * @returns {function}\n   */\n\n\n  function bufferFn(ms, fn) {\n    var timeout = undefined;\n    return function () {\n      clearTimeout(timeout);\n      timeout = setTimeout(fn, ms);\n    };\n  }\n  /**\n   * noop is a function which does nothing at all.\n   */\n\n\n  function noop() {}\n  /**\n   * copy properties from object o2 to object o1.\n   *\n   * @params {Object} o1\n   * @params {Object} o2\n   * @returns {Object}\n   */\n\n\n  function cp() {\n    var args = arguments;\n    var o1 = args[0];\n\n    for (var i = 1; i < args.length; ++i) {\n      var o2 = args[i] || {};\n\n      for (var key in o2) {\n        o1[key] = o2[key];\n      }\n    }\n\n    return o1;\n  }\n  /**\n   * @file Responsible for sanitizing and creating date picker options.\n   */\n\n\n  var english = {\n    days: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    months: ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'],\n    today: 'Today',\n    clear: 'Clear',\n    close: 'Close'\n  };\n  /**\n   * DatePickerOptions constructs a new date picker options object, overriding\n   * default values with any values specified in opts.\n   *\n   * @param {DatePickerOptions} opts\n   * @returns {DatePickerOptions}\n   */\n\n  function DatePickerOptions(opts) {\n    opts = opts || {};\n    opts = cp(defaults(), opts);\n    var parse = dateOrParse(opts.parse);\n    opts.lang = cp(english, opts.lang);\n    opts.parse = parse;\n    opts.inRange = makeInRangeFn(opts);\n    opts.min = parse(opts.min || shiftYear(now(), -100));\n    opts.max = parse(opts.max || shiftYear(now(), 100));\n    opts.hilightedDate = opts.parse(opts.hilightedDate);\n    return opts;\n  }\n\n  function defaults() {\n    return {\n      lang: english,\n      // Possible values: dp-modal, dp-below, dp-permanent\n      mode: 'dp-modal',\n      // The date to hilight initially if the date picker has no\n      // initial value.\n      hilightedDate: now(),\n      format: function (dt) {\n        return dt.getMonth() + 1 + '/' + dt.getDate() + '/' + dt.getFullYear();\n      },\n      parse: function (str) {\n        var date = new Date(str);\n        return isNaN(date) ? now() : date;\n      },\n      dateClass: function () {},\n      inRange: function () {\n        return true;\n      },\n      appendTo: document.body\n    };\n  }\n\n  function makeInRangeFn(opts) {\n    var inRange = opts.inRange; // Cache this version, and return a variant\n\n    return function (dt, dp) {\n      return inRange(dt, dp) && opts.min <= dt && opts.max >= dt;\n    };\n  }\n  /**\n   * @file Helper functions for dealing with dom elements.\n   */\n\n\n  var Key = {\n    left: 37,\n    up: 38,\n    right: 39,\n    down: 40,\n    enter: 13,\n    esc: 27\n  };\n  /**\n   * on attaches an event handler to the specified element, and returns an\n   * off function which can be used to remove the handler.\n   *\n   * @param {string} evt the name of the event to handle\n   * @param {HTMLElement} el the element to attach to\n   * @param {function} handler the event handler\n   * @returns {function} the off function\n   */\n\n  function on(evt, el, handler) {\n    el.addEventListener(evt, handler, true);\n    return function () {\n      el.removeEventListener(evt, handler, true);\n    };\n  }\n\n  var CustomEvent = shimCustomEvent();\n\n  function shimCustomEvent() {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    var CustomEvent = window.CustomEvent;\n\n    if (typeof CustomEvent !== 'function') {\n      CustomEvent = function (event, params) {\n        params = params || {\n          bubbles: false,\n          cancelable: false,\n          detail: undefined\n        };\n        var evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n      };\n\n      CustomEvent.prototype = window.Event.prototype;\n    }\n\n    return CustomEvent;\n  }\n  /**\n   * @file Manages the calendar / day-picker view.\n   */\n\n\n  var dayPicker = {\n    onKeyDown: keyDown,\n    onClick: {\n      'dp-day': selectDay,\n      'dp-next': gotoNextMonth,\n      'dp-prev': gotoPrevMonth,\n      'dp-today': selectToday,\n      'dp-clear': clear,\n      'dp-close': close,\n      'dp-cal-month': showMonthPicker,\n      'dp-cal-year': showYearPicker\n    },\n    render: render\n  };\n  /**\n   * view renders the calendar (day picker) as an HTML string.\n   *\n   * @param {DatePickerContext} context the date picker being rendered\n   * @returns {string}\n   */\n\n  function render(dp) {\n    var opts = dp.opts;\n    var lang = opts.lang;\n    var state = dp.state;\n    var dayNames = lang.days;\n    var dayOffset = opts.dayOffset || 0;\n    var selectedDate = state.selectedDate;\n    var hilightedDate = state.hilightedDate;\n    var hilightedMonth = hilightedDate.getMonth();\n    var today = now().getTime();\n    return '<div class=\"dp-cal\">' + '<header class=\"dp-cal-header\">' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-prev\">Prev</button>' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-cal-month\">' + lang.months[hilightedMonth] + '</button>' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-cal-year\">' + hilightedDate.getFullYear() + '</button>' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-next\">Next</button>' + '</header>' + '<div class=\"dp-days\">' + dayNames.map(function (name, i) {\n      return '<span class=\"dp-col-header\">' + dayNames[(i + dayOffset) % dayNames.length] + '</span>';\n    }).join('') + mapDays(hilightedDate, dayOffset, function (date) {\n      var isNotInMonth = date.getMonth() !== hilightedMonth;\n      var isDisabled = !opts.inRange(date);\n      var isToday = date.getTime() === today;\n      var className = 'dp-day';\n      className += isNotInMonth ? ' dp-edge-day' : '';\n      className += datesEq(date, hilightedDate) ? ' dp-current' : '';\n      className += datesEq(date, selectedDate) ? ' dp-selected' : '';\n      className += isDisabled ? ' dp-day-disabled' : '';\n      className += isToday ? ' dp-day-today' : '';\n      className += ' ' + opts.dateClass(date, dp);\n      return '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-date=\"' + date.getTime() + '\">' + date.getDate() + '</button>';\n    }) + '</div>' + '<footer class=\"dp-cal-footer\">' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-today\">' + lang.today + '</button>' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-clear\">' + lang.clear + '</button>' + '<button tabindex=\"-1\" type=\"button\" class=\"dp-close\">' + lang.close + '</button>' + '</footer>' + '</div>';\n  }\n  /**\n   * keyDown handles the key down event for the day-picker\n   *\n   * @param {Event} e\n   * @param {DatePickerContext} dp\n   */\n\n\n  function keyDown(e, dp) {\n    var key = e.keyCode;\n    var shiftBy = key === Key.left ? -1 : key === Key.right ? 1 : key === Key.up ? -7 : key === Key.down ? 7 : 0;\n\n    if (key === Key.esc) {\n      dp.close();\n    } else if (shiftBy) {\n      e.preventDefault();\n      dp.setState({\n        hilightedDate: shiftDay(dp.state.hilightedDate, shiftBy)\n      });\n    }\n  }\n\n  function selectToday(e, dp) {\n    dp.setState({\n      selectedDate: now()\n    });\n  }\n\n  function clear(e, dp) {\n    dp.setState({\n      selectedDate: null\n    });\n  }\n\n  function close(e, dp) {\n    dp.close();\n  }\n\n  function showMonthPicker(e, dp) {\n    dp.setState({\n      view: 'month'\n    });\n  }\n\n  function showYearPicker(e, dp) {\n    dp.setState({\n      view: 'year'\n    });\n  }\n\n  function gotoNextMonth(e, dp) {\n    var hilightedDate = dp.state.hilightedDate;\n    dp.setState({\n      hilightedDate: shiftMonth(hilightedDate, 1)\n    });\n  }\n\n  function gotoPrevMonth(e, dp) {\n    var hilightedDate = dp.state.hilightedDate;\n    dp.setState({\n      hilightedDate: shiftMonth(hilightedDate, -1)\n    });\n  }\n\n  function selectDay(e, dp) {\n    dp.setState({\n      selectedDate: new Date(parseInt(e.target.getAttribute('data-date')))\n    });\n  }\n\n  function mapDays(currentDate, dayOffset, fn) {\n    var result = '';\n    var iter = new Date(currentDate);\n    iter.setDate(1);\n    iter.setDate(1 - iter.getDay() + dayOffset); // If we are showing monday as the 1st of the week,\n    // and the monday is the 2nd of the month, the sunday won't\n    // show, so we need to shift backwards\n\n    if (dayOffset && iter.getDate() === dayOffset + 1) {\n      iter.setDate(dayOffset - 6);\n    } // We are going to have 6 weeks always displayed to keep a consistent\n    // calendar size\n\n\n    for (var day = 0; day < 6 * 7; ++day) {\n      result += fn(iter);\n      iter.setDate(iter.getDate() + 1);\n    }\n\n    return result;\n  }\n  /**\n   * @file Manages the month-picker view.\n   */\n\n\n  var monthPicker = {\n    onKeyDown: keyDown$1,\n    onClick: {\n      'dp-month': onChooseMonth\n    },\n    render: render$1\n  };\n\n  function onChooseMonth(e, dp) {\n    dp.setState({\n      hilightedDate: setMonth(dp.state.hilightedDate, parseInt(e.target.getAttribute('data-month'))),\n      view: 'day'\n    });\n  }\n  /**\n   * render renders the month picker as an HTML string\n   *\n   * @param {DatePickerContext} dp the date picker context\n   * @returns {string}\n   */\n\n\n  function render$1(dp) {\n    var opts = dp.opts;\n    var lang = opts.lang;\n    var months = lang.months;\n    var currentDate = dp.state.hilightedDate;\n    var currentMonth = currentDate.getMonth();\n    return '<div class=\"dp-months\">' + months.map(function (month, i) {\n      var className = 'dp-month';\n      className += currentMonth === i ? ' dp-current' : '';\n      return '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-month=\"' + i + '\">' + month + '</button>';\n    }).join('') + '</div>';\n  }\n  /**\n   * keyDown handles keydown events that occur in the month picker\n   *\n   * @param {Event} e\n  * @param {DatePickerContext} dp\n   */\n\n\n  function keyDown$1(e, dp) {\n    var key = e.keyCode;\n    var shiftBy = key === Key.left ? -1 : key === Key.right ? 1 : key === Key.up ? -3 : key === Key.down ? 3 : 0;\n\n    if (key === Key.esc) {\n      dp.setState({\n        view: 'day'\n      });\n    } else if (shiftBy) {\n      e.preventDefault();\n      dp.setState({\n        hilightedDate: shiftMonth(dp.state.hilightedDate, shiftBy, true)\n      });\n    }\n  }\n  /**\n   * @file Manages the year-picker view.\n   */\n\n\n  var yearPicker = {\n    render: render$2,\n    onKeyDown: keyDown$2,\n    onClick: {\n      'dp-year': onChooseYear\n    }\n  };\n  /**\n   * view renders the year picker as an HTML string.\n   *\n   * @param {DatePickerContext} dp the date picker context\n   * @returns {string}\n   */\n\n  function render$2(dp) {\n    var state = dp.state;\n    var currentYear = state.hilightedDate.getFullYear();\n    var selectedYear = state.selectedDate.getFullYear();\n    return '<div class=\"dp-years\">' + mapYears(dp, function (year) {\n      var className = 'dp-year';\n      className += year === currentYear ? ' dp-current' : '';\n      className += year === selectedYear ? ' dp-selected' : '';\n      return '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-year=\"' + year + '\">' + year + '</button>';\n    }) + '</div>';\n  }\n\n  function onChooseYear(e, dp) {\n    dp.setState({\n      hilightedDate: setYear(dp.state.hilightedDate, parseInt(e.target.getAttribute('data-year'))),\n      view: 'day'\n    });\n  }\n\n  function keyDown$2(e, dp) {\n    var key = e.keyCode;\n    var opts = dp.opts;\n    var shiftBy = key === Key.left || key === Key.up ? 1 : key === Key.right || key === Key.down ? -1 : 0;\n\n    if (key === Key.esc) {\n      dp.setState({\n        view: 'day'\n      });\n    } else if (shiftBy) {\n      e.preventDefault();\n      var shiftedYear = shiftYear(dp.state.hilightedDate, shiftBy);\n      dp.setState({\n        hilightedDate: constrainDate(shiftedYear, opts.min, opts.max)\n      });\n    }\n  }\n\n  function mapYears(dp, fn) {\n    var result = '';\n    var max = dp.opts.max.getFullYear();\n\n    for (var i = max; i >= dp.opts.min.getFullYear(); --i) {\n      result += fn(i);\n    }\n\n    return result;\n  }\n  /**\n   * @file Defines the base date picker behavior, overridden by various modes.\n   */\n\n\n  var views = {\n    day: dayPicker,\n    year: yearPicker,\n    month: monthPicker\n  };\n\n  function BaseMode(input, emit, opts) {\n    var detatchInputEvents; // A function that detaches all events from the input\n\n    var closing = false; // A hack to prevent calendar from re-opening when closing.\n\n    var selectedDate; // The currently selected date\n\n    var dp = {\n      // The root DOM element for the date picker, initialized on first open.\n      el: undefined,\n      opts: opts,\n      shouldFocusOnBlur: true,\n      shouldFocusOnRender: true,\n      state: initialState(),\n      adjustPosition: noop,\n      containerHTML: '<div class=\"dp\"></div>',\n      attachToDom: function () {\n        opts.appendTo.appendChild(dp.el);\n      },\n      updateInput: function (selectedDate) {\n        var e = new CustomEvent('change', {\n          bubbles: true\n        });\n        e.simulated = true;\n        input.value = selectedDate ? opts.format(selectedDate) : '';\n        input.dispatchEvent(e);\n      },\n      computeSelectedDate: function () {\n        return opts.parse(input.value);\n      },\n      currentView: function () {\n        return views[dp.state.view];\n      },\n      open: function () {\n        if (closing) {\n          return;\n        }\n\n        if (!dp.el) {\n          dp.el = createContainerElement(opts, dp.containerHTML);\n          attachContainerEvents(dp);\n        }\n\n        selectedDate = constrainDate(dp.computeSelectedDate(), opts.min, opts.max);\n        dp.state.hilightedDate = selectedDate || opts.hilightedDate;\n        dp.state.view = 'day';\n        dp.attachToDom();\n        dp.render();\n        emit('open');\n      },\n      isVisible: function () {\n        return !!dp.el && !!dp.el.parentNode;\n      },\n      hasFocus: function () {\n        var focused = document.activeElement;\n        return dp.el && dp.el.contains(focused) && focused.className.indexOf('dp-focuser') < 0;\n      },\n      shouldHide: function () {\n        return dp.isVisible();\n      },\n      close: function (becauseOfBlur) {\n        var el = dp.el;\n\n        if (!dp.isVisible()) {\n          return;\n        }\n\n        if (el) {\n          var parent = el.parentNode;\n          parent && parent.removeChild(el);\n        }\n\n        closing = true;\n\n        if (becauseOfBlur && dp.shouldFocusOnBlur) {\n          focusInput(input);\n        } // When we close, the input often gains refocus, which\n        // can then launch the date picker again, so we buffer\n        // a bit and don't show the date picker within N ms of closing\n\n\n        setTimeout(function () {\n          closing = false;\n        }, 100);\n        emit('close');\n      },\n      destroy: function () {\n        dp.close();\n        detatchInputEvents();\n      },\n      render: function () {\n        if (!dp.el) {\n          return;\n        }\n\n        var hadFocus = dp.hasFocus();\n        var html = dp.currentView().render(dp);\n        html && (dp.el.firstChild.innerHTML = html);\n        dp.adjustPosition();\n\n        if (hadFocus || dp.shouldFocusOnRender) {\n          focusCurrent(dp);\n        }\n      },\n      // Conceptually similar to setState in React, updates\n      // the view state and re-renders.\n      setState: function (state) {\n        for (var key in state) {\n          dp.state[key] = state[key];\n        }\n\n        emit('statechange');\n        dp.render();\n      }\n    };\n    detatchInputEvents = attachInputEvents(input, dp); // Builds the initial view state\n    // selectedDate is a special case and causes changes to hilightedDate\n    // hilightedDate is set on open, so remains undefined initially\n    // view is the current view (day, month, year)\n\n    function initialState() {\n      return {\n        get selectedDate() {\n          return selectedDate;\n        },\n\n        set selectedDate(dt) {\n          if (dt && !opts.inRange(dt)) {\n            return;\n          }\n\n          if (dt) {\n            selectedDate = new Date(dt);\n            dp.state.hilightedDate = selectedDate;\n          } else {\n            selectedDate = dt;\n          }\n\n          dp.updateInput(selectedDate);\n          emit('select');\n          dp.close();\n        },\n\n        view: 'day'\n      };\n    }\n\n    return dp;\n  }\n\n  function createContainerElement(opts, containerHTML) {\n    var el = document.createElement('div');\n    el.className = opts.mode;\n    el.innerHTML = containerHTML;\n    return el;\n  }\n\n  function attachInputEvents(input, dp) {\n    var bufferShow = bufferFn(5, function () {\n      if (dp.shouldHide()) {\n        dp.close();\n      } else {\n        dp.open();\n      }\n    });\n    var off = [on('blur', input, bufferFn(150, function () {\n      if (!dp.hasFocus()) {\n        dp.close(true);\n      }\n    })), on('mousedown', input, function () {\n      if (input === document.activeElement) {\n        bufferShow();\n      }\n    }), on('focus', input, bufferShow), on('input', input, function (e) {\n      var date = dp.opts.parse(e.target.value);\n      isNaN(date) || dp.setState({\n        hilightedDate: date\n      });\n    })]; // Unregister all events that were registered above.\n\n    return function () {\n      off.forEach(function (f) {\n        f();\n      });\n    };\n  }\n\n  function focusCurrent(dp) {\n    var current = dp.el.querySelector('.dp-current');\n    return current && current.focus();\n  }\n\n  function attachContainerEvents(dp) {\n    var el = dp.el;\n    var calEl = el.querySelector('.dp'); // Hack to get iOS to show active CSS states\n\n    el.ontouchstart = noop;\n\n    function onClick(e) {\n      e.target.className.split(' ').forEach(function (evt) {\n        var handler = dp.currentView().onClick[evt];\n        handler && handler(e, dp);\n      });\n    } // The calender fires a blur event *every* time we redraw\n    // this means we need to buffer the blur event to see if\n    // it still has no focus after redrawing, and only then\n    // do we return focus to the input. A possible other approach\n    // would be to set context.redrawing = true on redraw and\n    // set it to false in the blur event.\n\n\n    on('blur', calEl, bufferFn(150, function () {\n      if (!dp.hasFocus()) {\n        dp.close(true);\n      }\n    }));\n    on('keydown', el, function (e) {\n      if (e.keyCode === Key.enter) {\n        onClick(e);\n      } else {\n        dp.currentView().onKeyDown(e, dp);\n      }\n    }); // If the user clicks in non-focusable space, but\n    // still within the date picker, we don't want to\n    // hide, so we need to hack some things...\n\n    on('mousedown', calEl, function (e) {\n      e.target.focus && e.target.focus(); // IE hack\n\n      if (document.activeElement !== e.target) {\n        e.preventDefault();\n        focusCurrent(dp);\n      }\n    });\n    on('click', el, onClick);\n  }\n\n  function focusInput(input) {\n    // When the modal closes, we need to focus the original input so the\n    // user can continue tabbing from where they left off.\n    input.focus(); // iOS zonks out if we don't blur the input, so...\n\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n      input.blur();\n    }\n  }\n  /**\n   * @file Defines the modal date picker behavior.\n   */\n\n\n  function ModalMode(input, emit, opts) {\n    var dp = BaseMode(input, emit, opts); // In modal mode, users really shouldn't be able to type in\n    // the input, as all input is done via the calendar.\n\n    input.readonly = true; // In modal mode, we need to know when the user has tabbed\n    // off the end of the calendar, and set focus to the original\n    // input. To do this, we add a special element to the DOM.\n    // When the user tabs off the bottom of the calendar, they\n    // will tab onto this element.\n\n    dp.containerHTML += '<a href=\"#\" class=\"dp-focuser\">.</a>';\n    return dp;\n  }\n  /**\n   * @file Defines the dropdown date picker behavior.\n   */\n\n\n  function DropdownMode(input, emit, opts) {\n    var dp = BaseMode(input, emit, opts);\n    dp.shouldFocusOnBlur = false;\n    Object.defineProperty(dp, 'shouldFocusOnRender', {\n      get: function () {\n        return input !== document.activeElement;\n      }\n    });\n\n    dp.adjustPosition = function () {\n      autoPosition(input, dp);\n    };\n\n    return dp;\n  }\n\n  function autoPosition(input, dp) {\n    var inputPos = input.getBoundingClientRect();\n    var win = window;\n    adjustCalY(dp, inputPos, win);\n    adjustCalX(dp, inputPos, win);\n    dp.el.style.visibility = '';\n  }\n\n  function adjustCalX(dp, inputPos, win) {\n    var cal = dp.el;\n    var scrollLeft = win.pageXOffset;\n    var inputLeft = inputPos.left + scrollLeft;\n    var maxRight = win.innerWidth + scrollLeft;\n    var offsetWidth = cal.offsetWidth;\n    var calRight = inputLeft + offsetWidth;\n    var shiftedLeft = maxRight - offsetWidth;\n    var left = calRight > maxRight && shiftedLeft > 0 ? shiftedLeft : inputLeft;\n    cal.style.left = left + 'px';\n  }\n\n  function adjustCalY(dp, inputPos, win) {\n    var cal = dp.el;\n    var scrollTop = win.pageYOffset;\n    var inputTop = scrollTop + inputPos.top;\n    var calHeight = cal.offsetHeight;\n    var belowTop = inputTop + inputPos.height + 8;\n    var aboveTop = inputTop - calHeight - 8;\n    var isAbove = aboveTop > 0 && belowTop + calHeight > scrollTop + win.innerHeight;\n    var top = isAbove ? aboveTop : belowTop;\n\n    if (cal.classList) {\n      cal.classList.toggle('dp-is-above', isAbove);\n      cal.classList.toggle('dp-is-below', !isAbove);\n    }\n\n    cal.style.top = top + 'px';\n  }\n  /**\n   * @file Defines the permanent date picker behavior.\n   */\n\n\n  function PermanentMode(root, emit, opts) {\n    var dp = BaseMode(root, emit, opts);\n    dp.close = noop;\n    dp.updateInput = noop;\n    dp.shouldFocusOnRender = opts.shouldFocusOnRender;\n\n    dp.computeSelectedDate = function () {\n      return opts.hilightedDate;\n    };\n\n    dp.attachToDom = function () {\n      root.appendChild(dp.el);\n    };\n\n    dp.open();\n    return dp;\n  }\n  /**\n   * @file Defines the various date picker modes (modal, dropdown, permanent)\n   */\n\n\n  function Mode(input, emit, opts) {\n    input = input && input.tagName ? input : document.querySelector(input);\n\n    if (opts.mode === 'dp-modal') {\n      return ModalMode(input, emit, opts);\n    }\n\n    if (opts.mode === 'dp-below') {\n      return DropdownMode(input, emit, opts);\n    }\n\n    if (opts.mode === 'dp-permanent') {\n      return PermanentMode(input, emit, opts);\n    }\n  }\n  /**\n   * @file Defines simple event emitter behavior.\n   */\n\n  /**\n   * Emitter constructs a new emitter object which has on/off methods.\n   *\n   * @returns {EventEmitter}\n   */\n\n\n  function Emitter() {\n    var handlers = {};\n\n    function onOne(name, handler) {\n      (handlers[name] = handlers[name] || []).push(handler);\n    }\n\n    function onMany(fns) {\n      for (var name in fns) {\n        onOne(name, fns[name]);\n      }\n    }\n\n    return {\n      on: function (name, handler) {\n        if (handler) {\n          onOne(name, handler);\n        } else {\n          onMany(name);\n        }\n\n        return this;\n      },\n      emit: function (name, arg) {\n        (handlers[name] || []).forEach(function (handler) {\n          handler(name, arg);\n        });\n      },\n      off: function (name, handler) {\n        if (!name) {\n          handlers = {};\n        } else if (!handler) {\n          handlers[name] = [];\n        } else {\n          handlers[name] = (handlers[name] || []).filter(function (h) {\n            return h !== handler;\n          });\n        }\n\n        return this;\n      }\n    };\n  }\n  /**\n   * @file The root date picker file, defines public exports for the library.\n   */\n\n  /**\n  * The date picker language configuration\n  * @typedef {Object} LangOptions\n  * @property {Array.<string>} [days] - Days of the week\n  * @property {Array.<string>} [months] - Months of the year\n  * @property {string} today - The label for the 'today' button\n  * @property {string} close - The label for the 'close' button\n  * @property {string} clear - The label for the 'clear' button\n  */\n\n  /**\n  * The configuration options for a date picker.\n  *\n  * @typedef {Object} DatePickerOptions\n  * @property {LangOptions} [lang] - Configures the label text, defaults to English\n  * @property {('dp-modal'|'dp-below'|'dp-permanent')} [mode] - The date picker mode, defaults to 'dp-modal'\n  * @property {(string|Date)} [hilightedDate] - The date to hilight if no date is selected\n  * @property {function(string|Date):Date} [parse] - Parses a date, the complement of the \"format\" function\n  * @property {function(Date):string} [format] - Formats a date for displaying to user\n  * @property {function(Date):string} [dateClass] - Associates a custom CSS class with a date\n  * @property {function(Date):boolean} [inRange] - Indicates whether or not a date is selectable\n  * @property {(string|Date)} [min] - The minimum selectable date (inclusive, default 100 years ago)\n  * @property {(string|Date)} [max] - The maximum selectable date (inclusive, default 100 years from now)\n  */\n\n  /**\n  * The state values for the date picker\n  *\n  * @typedef {Object} DatePickerState\n  * @property {string} view - The current view 'day' | 'month' | 'year'\n  * @property {Date} selectedDate - The date which has been selected by the user\n  * @property {Date} hilightedDate - The date which is currently hilighted / active\n  */\n\n  /**\n  * An instance of TinyDatePicker\n  *\n  * @typedef {Object} DatePicker\n  * @property {DatePickerState} state - The values currently displayed.\n  * @property {function} on - Adds an event handler\n  * @property {function} off - Removes an event handler\n  * @property {function} setState - Changes the current state of the date picker\n  * @property {function} open - Opens the date picker\n  * @property {function} close - Closes the date picker\n  * @property {function} destroy - Destroys the date picker (removing all handlers from the input, too)\n  */\n\n  /**\n   * TinyDatePicker constructs a new date picker for the specified input\n   *\n   * @param {HTMLElement | string} input The input or CSS selector associated with the datepicker\n   * @param {DatePickerOptions} opts The options for initializing the date picker\n   * @returns {DatePicker}\n   */\n\n\n  function TinyDatePicker(input, opts) {\n    var emitter = Emitter();\n    var options = DatePickerOptions(opts);\n    var mode = Mode(input, emit, options);\n    var me = {\n      get state() {\n        return mode.state;\n      },\n\n      on: emitter.on,\n      off: emitter.off,\n      setState: mode.setState,\n      open: mode.open,\n      close: mode.close,\n      destroy: mode.destroy\n    };\n\n    function emit(evt) {\n      emitter.emit(evt, me);\n    }\n\n    return me;\n  }\n\n  return TinyDatePicker;\n});","map":{"version":3,"names":["global","factory","exports","module","define","amd","TinyDatePicker","now","dt","Date","setHours","datesEq","date1","date2","toDateString","shiftDay","n","setDate","getDate","shiftMonth","wrap","dayOfMonth","month","getMonth","setMonth","shiftYear","setFullYear","getFullYear","setYear","year","dateOrParse","parse","dropTime","constrainDate","min","max","bufferFn","ms","fn","timeout","undefined","clearTimeout","setTimeout","noop","cp","args","arguments","o1","i","length","o2","key","english","days","months","today","clear","close","DatePickerOptions","opts","defaults","lang","inRange","makeInRangeFn","hilightedDate","mode","format","str","date","isNaN","dateClass","appendTo","document","body","dp","Key","left","up","right","down","enter","esc","on","evt","el","handler","addEventListener","removeEventListener","CustomEvent","shimCustomEvent","window","event","params","bubbles","cancelable","detail","createEvent","initCustomEvent","prototype","Event","dayPicker","onKeyDown","keyDown","onClick","selectDay","gotoNextMonth","gotoPrevMonth","selectToday","showMonthPicker","showYearPicker","render","state","dayNames","dayOffset","selectedDate","hilightedMonth","getTime","map","name","join","mapDays","isNotInMonth","isDisabled","isToday","className","e","keyCode","shiftBy","preventDefault","setState","view","parseInt","target","getAttribute","currentDate","result","iter","getDay","day","monthPicker","keyDown$1","onChooseMonth","render$1","currentMonth","yearPicker","render$2","keyDown$2","onChooseYear","currentYear","selectedYear","mapYears","shiftedYear","views","BaseMode","input","emit","detatchInputEvents","closing","shouldFocusOnBlur","shouldFocusOnRender","initialState","adjustPosition","containerHTML","attachToDom","appendChild","updateInput","simulated","value","dispatchEvent","computeSelectedDate","currentView","open","createContainerElement","attachContainerEvents","isVisible","parentNode","hasFocus","focused","activeElement","contains","indexOf","shouldHide","becauseOfBlur","parent","removeChild","focusInput","destroy","hadFocus","html","firstChild","innerHTML","focusCurrent","attachInputEvents","createElement","bufferShow","off","forEach","f","current","querySelector","focus","calEl","ontouchstart","split","test","navigator","userAgent","MSStream","blur","ModalMode","readonly","DropdownMode","Object","defineProperty","get","autoPosition","inputPos","getBoundingClientRect","win","adjustCalY","adjustCalX","style","visibility","cal","scrollLeft","pageXOffset","inputLeft","maxRight","innerWidth","offsetWidth","calRight","shiftedLeft","scrollTop","pageYOffset","inputTop","top","calHeight","offsetHeight","belowTop","height","aboveTop","isAbove","innerHeight","classList","toggle","PermanentMode","root","Mode","tagName","Emitter","handlers","onOne","push","onMany","fns","arg","filter","h","emitter","options","me"],"sources":["C:/Users/javas/source/repos/Donuts and Devs LabJT/node_modules/tiny-date-picker/dist/tiny-date-picker.js"],"sourcesContent":["(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.TinyDatePicker = factory());\n}(this, (function () { 'use strict';\n\n  /**\n   * @file A generic set of mutation-free date functions.\n   */\n\n  /**\n   * now returns the current date without any time values\n   *\n   * @returns {Date}\n   */\n  function now() {\n    var dt = new Date();\n    dt.setHours(0, 0, 0, 0);\n    return dt;\n  }\n\n  /**\n   * dateEq compares two dates\n   *\n   * @param {Date} date1 the first date\n   * @param {Date} date2 the second date\n   * @returns {boolean}\n   */\n  function datesEq(date1, date2) {\n    return (date1 && date1.toDateString()) === (date2 && date2.toDateString());\n  }\n\n  /**\n   * shiftDay shifts the specified date by n days\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @returns {Date}\n   */\n  function shiftDay(dt, n) {\n    dt = new Date(dt);\n    dt.setDate(dt.getDate() + n);\n    return dt;\n  }\n\n  /**\n   * shiftMonth shifts the specified date by a specified number of months\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @param {boolean} wrap optional, if true, does not change year\n   *                       value, defaults to false\n   * @returns {Date}\n   */\n  function shiftMonth(dt, n, wrap) {\n    dt = new Date(dt);\n\n    var dayOfMonth = dt.getDate();\n    var month = dt.getMonth() + n;\n\n    dt.setDate(1);\n    dt.setMonth(wrap ? (12 + month) % 12 : month);\n    dt.setDate(dayOfMonth);\n\n    // If dayOfMonth = 31, but the target month only has 30 or 29 or whatever...\n    // head back to the max of the target month\n    if (dt.getDate() < dayOfMonth) {\n      dt.setDate(0);\n    }\n\n    return dt;\n  }\n\n  /**\n   * shiftYear shifts the specified date by n years\n   *\n   * @param {Date} dt\n   * @param {number} n\n   * @returns {Date}\n   */\n  function shiftYear(dt, n) {\n    dt = new Date(dt);\n    dt.setFullYear(dt.getFullYear() + n);\n    return dt;\n  }\n\n  /**\n   * setYear changes the specified date to the specified year\n   *\n   * @param {Date} dt\n   * @param {number} year\n   */\n  function setYear(dt, year) {\n    dt = new Date(dt);\n    dt.setFullYear(year);\n    return dt;\n  }\n\n  /**\n   * setMonth changes the specified date to the specified month\n   *\n   * @param {Date} dt\n   * @param {number} month\n   */\n  function setMonth(dt, month) {\n    return shiftMonth(dt, month - dt.getMonth());\n  }\n\n  /**\n   * dateOrParse creates a function which, given a date or string, returns a date\n   *\n   * @param {function} parse the function used to parse strings\n   * @returns {function}\n   */\n  function dateOrParse(parse) {\n    return function (dt) {\n      return dropTime(typeof dt === 'string' ? parse(dt) : dt);\n    };\n  }\n\n  /**\n   * constrainDate returns dt or min/max depending on whether dt is out of bounds (inclusive)\n   *\n   * @export\n   * @param {Date} dt\n   * @param {Date} min\n   * @param {Date} max\n   * @returns {Date}\n   */\n  function constrainDate(dt, min, max) {\n    return (dt < min) ? min :\n           (dt > max) ? max :\n           dt;\n  }\n\n  function dropTime(dt) {\n    dt = new Date(dt);\n    dt.setHours(0, 0, 0, 0);\n    return dt;\n  }\n\n  /**\n   * @file Utility functions for function manipulation.\n   */\n\n  /**\n   * bufferFn buffers calls to fn so they only happen every ms milliseconds\n   *\n   * @param {number} ms number of milliseconds\n   * @param {function} fn the function to be buffered\n   * @returns {function}\n   */\n  function bufferFn(ms, fn) {\n    var timeout = undefined;\n    return function () {\n      clearTimeout(timeout);\n      timeout = setTimeout(fn, ms);\n    };\n  }\n\n  /**\n   * noop is a function which does nothing at all.\n   */\n  function noop() { }\n\n  /**\n   * copy properties from object o2 to object o1.\n   *\n   * @params {Object} o1\n   * @params {Object} o2\n   * @returns {Object}\n   */\n  function cp() {\n    var args = arguments;\n    var o1 = args[0];\n    for (var i = 1; i < args.length; ++i) {\n      var o2 = args[i] || {};\n      for (var key in o2) {\n        o1[key] = o2[key];\n      }\n    }\n    return o1;\n  }\n\n  /**\n   * @file Responsible for sanitizing and creating date picker options.\n   */\n\n  var english = {\n    days: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    months: [\n      'January',\n      'February',\n      'March',\n      'April',\n      'May',\n      'June',\n      'July',\n      'August',\n      'September',\n      'October',\n      'November',\n      'December',\n    ],\n    today: 'Today',\n    clear: 'Clear',\n    close: 'Close',\n  };\n\n  /**\n   * DatePickerOptions constructs a new date picker options object, overriding\n   * default values with any values specified in opts.\n   *\n   * @param {DatePickerOptions} opts\n   * @returns {DatePickerOptions}\n   */\n  function DatePickerOptions(opts) {\n    opts = opts || {};\n    opts = cp(defaults(), opts);\n    var parse = dateOrParse(opts.parse);\n    opts.lang = cp(english, opts.lang);\n    opts.parse = parse;\n    opts.inRange = makeInRangeFn(opts);\n    opts.min = parse(opts.min || shiftYear(now(), -100));\n    opts.max = parse(opts.max || shiftYear(now(), 100));\n    opts.hilightedDate = opts.parse(opts.hilightedDate);\n\n    return opts;\n  }\n\n  function defaults() {\n    return {\n      lang: english,\n\n      // Possible values: dp-modal, dp-below, dp-permanent\n      mode: 'dp-modal',\n\n      // The date to hilight initially if the date picker has no\n      // initial value.\n      hilightedDate: now(),\n\n      format: function (dt) {\n        return (dt.getMonth() + 1) + '/' + dt.getDate() + '/' + dt.getFullYear();\n      },\n\n      parse: function (str) {\n        var date = new Date(str);\n        return isNaN(date) ? now() : date;\n      },\n\n      dateClass: function () { },\n\n      inRange: function () {\n        return true;\n      },\n\n      appendTo: document.body,\n    };\n  }\n\n  function makeInRangeFn(opts) {\n    var inRange = opts.inRange; // Cache this version, and return a variant\n\n    return function (dt, dp) {\n      return inRange(dt, dp) && opts.min <= dt && opts.max >= dt;\n    };\n  }\n\n  /**\n   * @file Helper functions for dealing with dom elements.\n   */\n\n  var Key = {\n    left: 37,\n    up: 38,\n    right: 39,\n    down: 40,\n    enter: 13,\n    esc: 27,\n  };\n\n  /**\n   * on attaches an event handler to the specified element, and returns an\n   * off function which can be used to remove the handler.\n   *\n   * @param {string} evt the name of the event to handle\n   * @param {HTMLElement} el the element to attach to\n   * @param {function} handler the event handler\n   * @returns {function} the off function\n   */\n  function on(evt, el, handler) {\n    el.addEventListener(evt, handler, true);\n\n    return function () {\n      el.removeEventListener(evt, handler, true);\n    };\n  }\n\n  var CustomEvent = shimCustomEvent();\n\n  function shimCustomEvent() {\n    if(typeof window === 'undefined') {return;}\n\n    var CustomEvent = window.CustomEvent;\n\n    if (typeof CustomEvent !== 'function') {\n      CustomEvent = function (event, params) {\n        params = params || {bubbles: false, cancelable: false, detail: undefined};\n        var evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n      };\n\n      CustomEvent.prototype = window.Event.prototype;\n    }\n\n    return CustomEvent;\n  }\n\n  /**\n   * @file Manages the calendar / day-picker view.\n   */\n\n  var dayPicker = {\n    onKeyDown: keyDown,\n    onClick: {\n      'dp-day': selectDay,\n      'dp-next': gotoNextMonth,\n      'dp-prev': gotoPrevMonth,\n      'dp-today': selectToday,\n      'dp-clear': clear,\n      'dp-close': close,\n      'dp-cal-month': showMonthPicker,\n      'dp-cal-year': showYearPicker,\n    },\n    render: render\n  };\n\n  /**\n   * view renders the calendar (day picker) as an HTML string.\n   *\n   * @param {DatePickerContext} context the date picker being rendered\n   * @returns {string}\n   */\n  function render(dp) {\n    var opts = dp.opts;\n    var lang = opts.lang;\n    var state = dp.state;\n    var dayNames = lang.days;\n    var dayOffset = opts.dayOffset || 0;\n    var selectedDate = state.selectedDate;\n    var hilightedDate = state.hilightedDate;\n    var hilightedMonth = hilightedDate.getMonth();\n    var today = now().getTime();\n\n    return (\n      '<div class=\"dp-cal\">' +\n        '<header class=\"dp-cal-header\">' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-prev\">Prev</button>' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-cal-month\">' +\n            lang.months[hilightedMonth] +\n          '</button>' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-cal-year\">' +\n            hilightedDate.getFullYear() +\n          '</button>' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-next\">Next</button>' +\n        '</header>' +\n        '<div class=\"dp-days\">' +\n          dayNames.map(function (name, i) {\n            return (\n              '<span class=\"dp-col-header\">' + dayNames[(i + dayOffset) % dayNames.length] + '</span>'\n            );\n          }).join('') +\n          mapDays(hilightedDate, dayOffset, function (date) {\n            var isNotInMonth = date.getMonth() !== hilightedMonth;\n            var isDisabled = !opts.inRange(date);\n            var isToday = date.getTime() === today;\n            var className = 'dp-day';\n            className += (isNotInMonth ? ' dp-edge-day' : '');\n            className += (datesEq(date, hilightedDate) ? ' dp-current' : '');\n            className += (datesEq(date, selectedDate) ? ' dp-selected' : '');\n            className += (isDisabled ? ' dp-day-disabled' : '');\n            className += (isToday ? ' dp-day-today' : '');\n            className += ' ' + opts.dateClass(date, dp);\n\n            return (\n              '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-date=\"' + date.getTime() + '\">' +\n                date.getDate() +\n              '</button>'\n            );\n          }) +\n        '</div>' +\n        '<footer class=\"dp-cal-footer\">' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-today\">' + lang.today + '</button>' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-clear\">' + lang.clear + '</button>' +\n          '<button tabindex=\"-1\" type=\"button\" class=\"dp-close\">' + lang.close + '</button>' +\n        '</footer>' +\n      '</div>'\n    );\n  }\n\n  /**\n   * keyDown handles the key down event for the day-picker\n   *\n   * @param {Event} e\n   * @param {DatePickerContext} dp\n   */\n  function keyDown(e, dp) {\n    var key = e.keyCode;\n    var shiftBy =\n      (key === Key.left) ? -1 :\n      (key === Key.right) ? 1 :\n      (key === Key.up) ? -7 :\n      (key === Key.down) ? 7 :\n      0;\n\n    if (key === Key.esc) {\n      dp.close();\n    } else if (shiftBy) {\n      e.preventDefault();\n      dp.setState({\n        hilightedDate: shiftDay(dp.state.hilightedDate, shiftBy)\n      });\n    }\n  }\n\n  function selectToday(e, dp) {\n    dp.setState({\n      selectedDate: now(),\n    });\n  }\n\n  function clear(e, dp) {\n    dp.setState({\n      selectedDate: null,\n    });\n  }\n\n  function close(e, dp) {\n    dp.close();\n  }\n\n  function showMonthPicker(e, dp) {\n    dp.setState({\n      view: 'month'\n    });\n  }\n\n  function showYearPicker(e, dp) {\n    dp.setState({\n      view: 'year'\n    });\n  }\n\n  function gotoNextMonth(e, dp) {\n    var hilightedDate = dp.state.hilightedDate;\n    dp.setState({\n      hilightedDate: shiftMonth(hilightedDate, 1)\n    });\n  }\n\n  function gotoPrevMonth(e, dp) {\n    var hilightedDate = dp.state.hilightedDate;\n    dp.setState({\n      hilightedDate: shiftMonth(hilightedDate, -1)\n    });\n  }\n\n  function selectDay(e, dp) {\n    dp.setState({\n      selectedDate: new Date(parseInt(e.target.getAttribute('data-date'))),\n    });\n  }\n\n  function mapDays(currentDate, dayOffset, fn) {\n    var result = '';\n    var iter = new Date(currentDate);\n    iter.setDate(1);\n    iter.setDate(1 - iter.getDay() + dayOffset);\n\n    // If we are showing monday as the 1st of the week,\n    // and the monday is the 2nd of the month, the sunday won't\n    // show, so we need to shift backwards\n    if (dayOffset && iter.getDate() === dayOffset + 1) {\n      iter.setDate(dayOffset - 6);\n    }\n\n    // We are going to have 6 weeks always displayed to keep a consistent\n    // calendar size\n    for (var day = 0; day < (6 * 7); ++day) {\n      result += fn(iter);\n      iter.setDate(iter.getDate() + 1);\n    }\n\n    return result;\n  }\n\n  /**\n   * @file Manages the month-picker view.\n   */\n\n  var monthPicker = {\n    onKeyDown: keyDown$1,\n    onClick: {\n      'dp-month': onChooseMonth\n    },\n    render: render$1\n  };\n\n  function onChooseMonth(e, dp) {\n    dp.setState({\n      hilightedDate: setMonth(dp.state.hilightedDate, parseInt(e.target.getAttribute('data-month'))),\n      view: 'day',\n    });\n  }\n\n  /**\n   * render renders the month picker as an HTML string\n   *\n   * @param {DatePickerContext} dp the date picker context\n   * @returns {string}\n   */\n  function render$1(dp) {\n    var opts = dp.opts;\n    var lang = opts.lang;\n    var months = lang.months;\n    var currentDate = dp.state.hilightedDate;\n    var currentMonth = currentDate.getMonth();\n\n    return (\n      '<div class=\"dp-months\">' +\n        months.map(function (month, i) {\n          var className = 'dp-month';\n          className += (currentMonth === i ? ' dp-current' : '');\n\n          return (\n            '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-month=\"' + i + '\">' +\n              month +\n            '</button>'\n          );\n        }).join('') +\n      '</div>'\n    );\n  }\n\n  /**\n   * keyDown handles keydown events that occur in the month picker\n   *\n   * @param {Event} e\n  * @param {DatePickerContext} dp\n   */\n  function keyDown$1(e, dp) {\n    var key = e.keyCode;\n    var shiftBy =\n      (key === Key.left) ? -1 :\n      (key === Key.right) ? 1 :\n      (key === Key.up) ? -3 :\n      (key === Key.down) ? 3 :\n      0;\n\n    if (key === Key.esc) {\n      dp.setState({\n        view: 'day',\n      });\n    } else if (shiftBy) {\n      e.preventDefault();\n      dp.setState({\n        hilightedDate: shiftMonth(dp.state.hilightedDate, shiftBy, true)\n      });\n    }\n  }\n\n  /**\n   * @file Manages the year-picker view.\n   */\n\n  var yearPicker = {\n    render: render$2,\n    onKeyDown: keyDown$2,\n    onClick: {\n      'dp-year': onChooseYear\n    },\n  };\n\n  /**\n   * view renders the year picker as an HTML string.\n   *\n   * @param {DatePickerContext} dp the date picker context\n   * @returns {string}\n   */\n  function render$2(dp) {\n    var state = dp.state;\n    var currentYear = state.hilightedDate.getFullYear();\n    var selectedYear = state.selectedDate.getFullYear();\n\n    return (\n      '<div class=\"dp-years\">' +\n        mapYears(dp, function (year) {\n          var className = 'dp-year';\n          className += (year === currentYear ? ' dp-current' : '');\n          className += (year === selectedYear ? ' dp-selected' : '');\n\n          return (\n            '<button tabindex=\"-1\" type=\"button\" class=\"' + className + '\" data-year=\"' + year + '\">' +\n              year +\n            '</button>'\n          );\n        }) +\n      '</div>'\n    );\n  }\n\n  function onChooseYear(e, dp) {\n    dp.setState({\n      hilightedDate: setYear(dp.state.hilightedDate, parseInt(e.target.getAttribute('data-year'))),\n      view: 'day',\n    });\n  }\n\n  function keyDown$2(e, dp) {\n    var key = e.keyCode;\n    var opts = dp.opts;\n    var shiftBy =\n      (key === Key.left || key === Key.up) ? 1 :\n      (key === Key.right || key === Key.down) ? -1 :\n      0;\n\n    if (key === Key.esc) {\n      dp.setState({\n        view: 'day',\n      });\n    } else if (shiftBy) {\n      e.preventDefault();\n      var shiftedYear = shiftYear(dp.state.hilightedDate, shiftBy);\n\n      dp.setState({\n        hilightedDate: constrainDate(shiftedYear, opts.min, opts.max),\n      });\n    }\n  }\n\n  function mapYears(dp, fn) {\n    var result = '';\n    var max = dp.opts.max.getFullYear();\n\n    for (var i = max; i >= dp.opts.min.getFullYear(); --i) {\n      result += fn(i);\n    }\n\n    return result;\n  }\n\n  /**\n   * @file Defines the base date picker behavior, overridden by various modes.\n   */\n\n  var views = {\n    day: dayPicker,\n    year: yearPicker,\n    month: monthPicker\n  };\n\n  function BaseMode(input, emit, opts) {\n    var detatchInputEvents; // A function that detaches all events from the input\n    var closing = false; // A hack to prevent calendar from re-opening when closing.\n    var selectedDate; // The currently selected date\n    var dp = {\n      // The root DOM element for the date picker, initialized on first open.\n      el: undefined,\n      opts: opts,\n      shouldFocusOnBlur: true,\n      shouldFocusOnRender: true,\n      state: initialState(),\n      adjustPosition: noop,\n      containerHTML: '<div class=\"dp\"></div>',\n\n      attachToDom: function () {\n        opts.appendTo.appendChild(dp.el);\n      },\n\n      updateInput: function (selectedDate) {\n        var e = new CustomEvent('change', {bubbles: true});\n        e.simulated = true;\n        input.value = selectedDate ? opts.format(selectedDate) : '';\n        input.dispatchEvent(e);\n      },\n\n      computeSelectedDate: function () {\n        return opts.parse(input.value);\n      },\n\n      currentView: function() {\n        return views[dp.state.view];\n      },\n\n      open: function () {\n        if (closing) {\n          return;\n        }\n\n        if (!dp.el) {\n          dp.el = createContainerElement(opts, dp.containerHTML);\n          attachContainerEvents(dp);\n        }\n\n        selectedDate = constrainDate(dp.computeSelectedDate(), opts.min, opts.max);\n        dp.state.hilightedDate = selectedDate || opts.hilightedDate;\n        dp.state.view = 'day';\n\n        dp.attachToDom();\n        dp.render();\n\n        emit('open');\n      },\n\n      isVisible: function () {\n        return !!dp.el && !!dp.el.parentNode;\n      },\n\n      hasFocus: function () {\n        var focused = document.activeElement;\n        return dp.el &&\n          dp.el.contains(focused) &&\n          focused.className.indexOf('dp-focuser') < 0;\n      },\n\n      shouldHide: function () {\n        return dp.isVisible();\n      },\n\n      close: function (becauseOfBlur) {\n        var el = dp.el;\n\n        if (!dp.isVisible()) {\n          return;\n        }\n\n        if (el) {\n          var parent = el.parentNode;\n          parent && parent.removeChild(el);\n        }\n\n        closing = true;\n\n        if (becauseOfBlur && dp.shouldFocusOnBlur) {\n          focusInput(input);\n        }\n\n        // When we close, the input often gains refocus, which\n        // can then launch the date picker again, so we buffer\n        // a bit and don't show the date picker within N ms of closing\n        setTimeout(function() {\n          closing = false;\n        }, 100);\n\n        emit('close');\n      },\n\n      destroy: function () {\n        dp.close();\n        detatchInputEvents();\n      },\n\n      render: function () {\n        if (!dp.el) {\n          return;\n        }\n\n        var hadFocus = dp.hasFocus();\n        var html = dp.currentView().render(dp);\n        html && (dp.el.firstChild.innerHTML = html);\n\n        dp.adjustPosition();\n\n        if (hadFocus || dp.shouldFocusOnRender) {\n          focusCurrent(dp);\n        }\n      },\n\n      // Conceptually similar to setState in React, updates\n      // the view state and re-renders.\n      setState: function (state) {\n        for (var key in state) {\n          dp.state[key] = state[key];\n        }\n\n        emit('statechange');\n        dp.render();\n      },\n    };\n\n    detatchInputEvents = attachInputEvents(input, dp);\n\n    // Builds the initial view state\n    // selectedDate is a special case and causes changes to hilightedDate\n    // hilightedDate is set on open, so remains undefined initially\n    // view is the current view (day, month, year)\n    function initialState() {\n      return {\n        get selectedDate() {\n          return selectedDate;\n        },\n        set selectedDate(dt) {\n          if (dt && !opts.inRange(dt)) {\n            return;\n          }\n\n          if (dt) {\n            selectedDate = new Date(dt);\n            dp.state.hilightedDate = selectedDate;\n          } else {\n            selectedDate = dt;\n          }\n\n          dp.updateInput(selectedDate);\n          emit('select');\n          dp.close();\n        },\n        view: 'day',\n      };\n    }\n\n    return dp;\n  }\n\n  function createContainerElement(opts, containerHTML) {\n    var el = document.createElement('div');\n\n    el.className = opts.mode;\n    el.innerHTML = containerHTML;\n\n    return el;\n  }\n\n  function attachInputEvents(input, dp) {\n    var bufferShow = bufferFn(5, function () {\n      if (dp.shouldHide()) {\n        dp.close();\n      } else {\n        dp.open();\n      }\n    });\n\n    var off = [\n      on('blur', input, bufferFn(150, function () {\n        if (!dp.hasFocus()) {\n          dp.close(true);\n        }\n      })),\n\n      on('mousedown', input, function () {\n        if (input === document.activeElement) {\n          bufferShow();\n        }\n      }),\n\n      on('focus', input, bufferShow),\n\n      on('input', input, function (e) {\n        var date = dp.opts.parse(e.target.value);\n        isNaN(date) || dp.setState({\n          hilightedDate: date\n        });\n      }),\n    ];\n\n    // Unregister all events that were registered above.\n    return function() {\n      off.forEach(function (f) {\n        f();\n      });\n    };\n  }\n\n  function focusCurrent(dp) {\n    var current = dp.el.querySelector('.dp-current');\n    return current && current.focus();\n  }\n\n  function attachContainerEvents(dp) {\n    var el = dp.el;\n    var calEl = el.querySelector('.dp');\n\n    // Hack to get iOS to show active CSS states\n    el.ontouchstart = noop;\n\n    function onClick(e) {\n      e.target.className.split(' ').forEach(function(evt) {\n        var handler = dp.currentView().onClick[evt];\n        handler && handler(e, dp);\n      });\n    }\n\n    // The calender fires a blur event *every* time we redraw\n    // this means we need to buffer the blur event to see if\n    // it still has no focus after redrawing, and only then\n    // do we return focus to the input. A possible other approach\n    // would be to set context.redrawing = true on redraw and\n    // set it to false in the blur event.\n    on('blur', calEl, bufferFn(150, function () {\n      if (!dp.hasFocus()) {\n        dp.close(true);\n      }\n    }));\n\n    on('keydown', el, function (e) {\n      if (e.keyCode === Key.enter) {\n        onClick(e);\n      } else {\n        dp.currentView().onKeyDown(e, dp);\n      }\n    });\n\n    // If the user clicks in non-focusable space, but\n    // still within the date picker, we don't want to\n    // hide, so we need to hack some things...\n    on('mousedown', calEl, function (e) {\n      e.target.focus && e.target.focus(); // IE hack\n      if (document.activeElement !== e.target) {\n        e.preventDefault();\n        focusCurrent(dp);\n      }\n    });\n\n    on('click', el, onClick);\n  }\n\n  function focusInput(input) {\n    // When the modal closes, we need to focus the original input so the\n    // user can continue tabbing from where they left off.\n    input.focus();\n\n    // iOS zonks out if we don't blur the input, so...\n    if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {\n      input.blur();\n    }\n  }\n\n  /**\n   * @file Defines the modal date picker behavior.\n   */\n\n  function ModalMode(input, emit, opts) {\n    var dp = BaseMode(input, emit, opts);\n\n    // In modal mode, users really shouldn't be able to type in\n    // the input, as all input is done via the calendar.\n    input.readonly = true;\n\n    // In modal mode, we need to know when the user has tabbed\n    // off the end of the calendar, and set focus to the original\n    // input. To do this, we add a special element to the DOM.\n    // When the user tabs off the bottom of the calendar, they\n    // will tab onto this element.\n    dp.containerHTML += '<a href=\"#\" class=\"dp-focuser\">.</a>';\n\n    return dp;\n  }\n\n  /**\n   * @file Defines the dropdown date picker behavior.\n   */\n\n  function DropdownMode(input, emit, opts) {\n    var dp = BaseMode(input, emit, opts);\n\n    dp.shouldFocusOnBlur = false;\n\n    Object.defineProperty(dp, 'shouldFocusOnRender', {\n      get: function() {\n        return input !== document.activeElement;\n      }\n    });\n\n    dp.adjustPosition = function () {\n      autoPosition(input, dp);\n    };\n\n    return dp;\n  }\n\n  function autoPosition(input, dp) {\n    var inputPos = input.getBoundingClientRect();\n    var win = window;\n\n    adjustCalY(dp, inputPos, win);\n    adjustCalX(dp, inputPos, win);\n\n    dp.el.style.visibility = '';\n  }\n\n  function adjustCalX(dp, inputPos, win) {\n    var cal = dp.el;\n    var scrollLeft = win.pageXOffset;\n    var inputLeft = inputPos.left + scrollLeft;\n    var maxRight = win.innerWidth + scrollLeft;\n    var offsetWidth = cal.offsetWidth;\n    var calRight = inputLeft + offsetWidth;\n    var shiftedLeft = maxRight - offsetWidth;\n    var left = calRight > maxRight && shiftedLeft > 0 ? shiftedLeft : inputLeft;\n\n    cal.style.left = left + 'px';\n  }\n\n  function adjustCalY(dp, inputPos, win) {\n    var cal = dp.el;\n    var scrollTop = win.pageYOffset;\n    var inputTop = scrollTop + inputPos.top;\n    var calHeight = cal.offsetHeight;\n    var belowTop = inputTop + inputPos.height + 8;\n    var aboveTop = inputTop - calHeight - 8;\n    var isAbove = (aboveTop > 0 && belowTop + calHeight > scrollTop + win.innerHeight);\n    var top = isAbove ? aboveTop : belowTop;\n\n    if (cal.classList) {\n      cal.classList.toggle('dp-is-above', isAbove);\n      cal.classList.toggle('dp-is-below', !isAbove);\n    }\n    cal.style.top = top + 'px';\n  }\n\n  /**\n   * @file Defines the permanent date picker behavior.\n   */\n\n  function PermanentMode(root, emit, opts) {\n    var dp = BaseMode(root, emit, opts);\n\n    dp.close = noop;\n    dp.updateInput = noop;\n    dp.shouldFocusOnRender = opts.shouldFocusOnRender;\n\n    dp.computeSelectedDate = function () {\n      return opts.hilightedDate;\n    };\n\n    dp.attachToDom = function () {\n      root.appendChild(dp.el);\n    };\n\n    dp.open();\n\n    return dp;\n  }\n\n  /**\n   * @file Defines the various date picker modes (modal, dropdown, permanent)\n   */\n\n  function Mode(input, emit, opts) {\n    input = input && input.tagName ? input : document.querySelector(input);\n\n    if (opts.mode === 'dp-modal') {\n      return ModalMode(input, emit, opts);\n    }\n\n    if (opts.mode === 'dp-below') {\n      return DropdownMode(input, emit, opts);\n    }\n\n    if (opts.mode === 'dp-permanent') {\n      return PermanentMode(input, emit, opts);\n    }\n  }\n\n  /**\n   * @file Defines simple event emitter behavior.\n   */\n\n  /**\n   * Emitter constructs a new emitter object which has on/off methods.\n   *\n   * @returns {EventEmitter}\n   */\n  function Emitter() {\n    var handlers = {};\n\n    function onOne(name, handler) {\n      (handlers[name] = (handlers[name] || [])).push(handler);\n    }\n\n    function onMany(fns) {\n      for (var name in fns) {\n        onOne(name, fns[name]);\n      }\n    }\n\n    return {\n      on: function (name, handler) {\n        if (handler) {\n          onOne(name, handler);\n        } else {\n          onMany(name);\n        }\n\n        return this;\n      },\n\n      emit: function (name, arg) {\n        (handlers[name] || []).forEach(function (handler) {\n          handler(name, arg);\n        });\n      },\n\n      off: function (name, handler) {\n        if (!name) {\n          handlers = {};\n        } else if (!handler) {\n          handlers[name] = [];\n        } else {\n          handlers[name] = (handlers[name] || []).filter(function (h) {\n            return h !== handler;\n          });\n        }\n\n        return this;\n      }\n    };\n  }\n\n  /**\n   * @file The root date picker file, defines public exports for the library.\n   */\n\n  /**\n  * The date picker language configuration\n  * @typedef {Object} LangOptions\n  * @property {Array.<string>} [days] - Days of the week\n  * @property {Array.<string>} [months] - Months of the year\n  * @property {string} today - The label for the 'today' button\n  * @property {string} close - The label for the 'close' button\n  * @property {string} clear - The label for the 'clear' button\n  */\n\n  /**\n  * The configuration options for a date picker.\n  *\n  * @typedef {Object} DatePickerOptions\n  * @property {LangOptions} [lang] - Configures the label text, defaults to English\n  * @property {('dp-modal'|'dp-below'|'dp-permanent')} [mode] - The date picker mode, defaults to 'dp-modal'\n  * @property {(string|Date)} [hilightedDate] - The date to hilight if no date is selected\n  * @property {function(string|Date):Date} [parse] - Parses a date, the complement of the \"format\" function\n  * @property {function(Date):string} [format] - Formats a date for displaying to user\n  * @property {function(Date):string} [dateClass] - Associates a custom CSS class with a date\n  * @property {function(Date):boolean} [inRange] - Indicates whether or not a date is selectable\n  * @property {(string|Date)} [min] - The minimum selectable date (inclusive, default 100 years ago)\n  * @property {(string|Date)} [max] - The maximum selectable date (inclusive, default 100 years from now)\n  */\n\n  /**\n  * The state values for the date picker\n  *\n  * @typedef {Object} DatePickerState\n  * @property {string} view - The current view 'day' | 'month' | 'year'\n  * @property {Date} selectedDate - The date which has been selected by the user\n  * @property {Date} hilightedDate - The date which is currently hilighted / active\n  */\n\n  /**\n  * An instance of TinyDatePicker\n  *\n  * @typedef {Object} DatePicker\n  * @property {DatePickerState} state - The values currently displayed.\n  * @property {function} on - Adds an event handler\n  * @property {function} off - Removes an event handler\n  * @property {function} setState - Changes the current state of the date picker\n  * @property {function} open - Opens the date picker\n  * @property {function} close - Closes the date picker\n  * @property {function} destroy - Destroys the date picker (removing all handlers from the input, too)\n  */\n\n  /**\n   * TinyDatePicker constructs a new date picker for the specified input\n   *\n   * @param {HTMLElement | string} input The input or CSS selector associated with the datepicker\n   * @param {DatePickerOptions} opts The options for initializing the date picker\n   * @returns {DatePicker}\n   */\n  function TinyDatePicker(input, opts) {\n    var emitter = Emitter();\n    var options = DatePickerOptions(opts);\n    var mode = Mode(input, emit, options);\n    var me = {\n      get state() {\n        return mode.state;\n      },\n      on: emitter.on,\n      off: emitter.off,\n      setState: mode.setState,\n      open: mode.open,\n      close: mode.close,\n      destroy: mode.destroy,\n    };\n\n    function emit(evt) {\n      emitter.emit(evt, me);\n    }\n\n    return me;\n  }\n\n  return TinyDatePicker;\n\n})));\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}